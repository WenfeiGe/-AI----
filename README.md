# 雪浪制造AI挑战赛
比赛；链接：https://tianchi.aliyun.com/competition/information.htm?spm=5176.100067.5678.2.37791756dvC7eR&raceId=231666
初赛73/2403，复赛22/2403，所有代码+介绍




初赛思路：
对于初赛，题目要求只需要将所有的图片分类为：正常or瑕疵就行，刚开始的思路就很简单，直接把正常图片放在一个文件夹，瑕疵图片放在另一个文件夹，（首先对所有图片进行resize，原图大小为2560*1920，GPU也跑不动，因此resize到320*320）然后选一个模型，用keras训练走了一遍……然后发现效果巨烂（acc大概0.8左右）。
然后分析了一下数据集，发现了很多问题：
1.	数据集不平衡，正常图片的数量大约是瑕疵图片的两倍；
2.	瑕疵在整张图片中非常小，resize更是损失了很多信息，但是不经过resize又不能训练；
3.	模型怎么选合适？优化器怎么选合适？……
经过试验和摸索，选择了优化数据集的方式如下：
（1）	原图resize到499 * 499大小；
（2）	对于有瑕疵的图片，对瑕疵部位进行多次采样，将图片中与瑕疵所在的标注框的交并比大于一定阈值的图像区域resize到499 * 499大小，也作为瑕疵样本参与训练；
（3）	分别测试VGG系列模型以及Resnet、Inception等多种模型，选出最合适的模型构架；
（4）	尝试不同的优化器、加dropout、GAP层、BN等调参过程优化。
其中第1,2步处理的依据为：对于有些瑕疵，其具有全局特征，比如边扎洞等，需要用整张图像进行训练；但是对于毛洞等局部小瑕疵，resize并不能很好地保留特征，因此需要对瑕疵部位进行重点采样并训练，确保模型可以识别瑕疵特征。同时，对瑕疵的采样过程也充实了瑕疵样本，这样可以让瑕疵样本和正常样本数量达到平衡。
最后选用VGG-13模型为基础，在最终的参数调整之后，准确率达0.91。

初赛用到的所有代码都放在了初赛文件夹，可以通过main文件直接运行，使用方法参考初赛文件夹下的readme文件，数据可以在官网下载。



复赛思路:
